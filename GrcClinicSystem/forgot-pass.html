<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forgot Password - GRC Clinic</title>
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</head>
<style>
      /* Global Styling for Login */
body {
  font-family: 'Poppins', sans-serif;
  margin: 0;
  background: linear-gradient(135deg, #9c2222, #b34b4b 80%);
  color: #111;
  display: flex;
  height: 100vh;
  align-items: center;
  justify-content: center;
}

/* Container Layout */
.container {
  width: 100%;
  max-width: 1000px;
  min-height: 600px;
  background: #fff;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  display: flex;
}

/* Left Section */
.grc-img {
  flex: 1;
  background: linear-gradient(135deg, #7a1b1b 0%, #b34b4b 100%);
  color: white;
  padding: 10px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 20px;
  text-align: center;
}

.grc-img img {
  width: 450px;
  height: auto;
  object-fit: contain;
}

.grc-img h1 {
  font-size: clamp(20px, 3vw, 32px);
  margin: 0;
  line-height: 1.4;
  font-weight: 800;
  letter-spacing: 1px;
  max-width: 90%;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  font-size: 20px;
}

/* Right (Form) Section */
.form-container {
  flex: 1;
  padding: 40px 50px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

h2 {
  font-weight: 700;
  margin-bottom: 25px;
  color: #7a1b1b;
  text-align: center;
}

/* Form Elements */
form {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

label {
  font-size: 14px;
  font-weight: 500;
}

  input[type="text"],
  input[type="email"],
  input[type="password"],
  select {
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 15px;
    outline: none;
    transition: 0.3s ease;
  }

  input:focus,
  select:focus {
    border-color: #7a1b1b;
    box-shadow: 0 0 6px rgba(122, 27, 27, 0.3);
  }

/* Password Field */
.password {
  position: relative;
}

.password input {
  width: 85%;
  padding-right: 50px;
}

.toggle-password {
  position: absolute;
  top: 50%;
  right: 12px;
  transform: translateY(-50%);
  cursor: pointer;
  font-size: 20px;
  color: #7a1b1b;
  transition: transform 0.2s;
}

.toggle-password:hover {
  transform: translateY(-50%) scale(1.1);
}

/* Remember/Forgot */
.remember-forgot {
  font-size: 13px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.remember-forgot a {
  color: #7a1b1b;
  text-decoration: none;
  font-weight: 600;
}

.remember-forgot a:hover {
  text-decoration: underline;
}

/* Button */
button {
  background: linear-gradient(135deg, #7a1b1b, #b34b4b);
  border: none;
  padding: 12px;
  border-radius: 25px;
  color: white;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(122, 27, 27, 0.3);
}

/* Switch Link */
.switch-link {
  font-size: 14px;
  margin-top: 15px;
  text-align: center;
  cursor: pointer;
}

.switch-link a {
  color: #7a1b1b;
  text-decoration: none;
  font-weight: 600;
}

.switch-link a:hover {
  text-decoration: underline;
}
/* Error message styling */
#message.error {
  color: #be0808;        /* Change this to any color you like */
  font-size: 14px;       /* Adjust the size as needed */
  margin-top: 10px;      /* Optional: spacing from the input */
}

#message.success {
  color: rgb(0, 137, 0);      /* Success color */
  font-size: 14px;      /* Adjust size */
  margin-top: 10px;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .container {
    flex-direction: column;
    max-width: 95%;
  }

  .grc-img,
  .form-container {
    flex: none;
    width: 100%;
    padding: 25px;
  }

  .grc-img img {
    width: 150px;
  }
}
</style>
<body>
  <div class="container">
    <div class="grc-img">
      <img src="grc.png" alt="GRC Clinic Logo">
          <h1>CLINIC RECEPTION SYSTEM WITH PATIENT RELATIONSHIP MANAGEMENT</h1>
    </div>
    <div class="form-container">
      <form id="forgot-password-form">
        <h2>Forgot Password</h2>
        
        <label for="forgot-email">Email Address</label>
        <input type="email" id="forgot-email" placeholder="Enter your email" required>
        
        <label for="new-password">New Password</label>
        <div class="password">
          <input type="password" id="new-password" placeholder="Enter new password" required maxlength="20">
          <span class="toggle-password" data-target="new-password">
            <ion-icon name="eye-off-outline"></ion-icon>
          </span>
        </div>
        
        <label for="confirm-password">Confirm New Password</label>
        <div class="password">
          <input type="password" id="confirm-password" placeholder="Confirm new password" required maxlength="20">
          <span class="toggle-password" data-target="confirm-password">
            <ion-icon name="eye-off-outline"></ion-icon>
          </span>
        </div>
        
        <div id="message"></div>
        <button type="submit">Reset Password</button>
        <div class="switch-link">Go to <a href="login.html">Login Page</a> </div>
      </form>
    </div>
  </div>

  <script>
const form = document.getElementById('forgot-password-form');
const emailInput = document.getElementById('forgot-email');
const newPassword = document.getElementById('new-password');
const confirmPassword = document.getElementById('confirm-password');
const messageBox = document.getElementById('message');
const submitBtn = form.querySelector('button');

// Toggle password visibility
document.querySelectorAll('.toggle-password').forEach(el => {
  el.addEventListener('click', () => {
    const target = document.getElementById(el.dataset.target);
    const icon = el.querySelector('ion-icon');
    target.type = target.type === 'password' ? 'text' : 'password';
    icon.setAttribute('name', target.type === 'password' ? 'eye-off-outline' : 'eye-outline');
  });
});

// Password complexity check
function validatePasswordComplexity(password) {
  return /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/.test(password);
}

// Real-time validation
function validateForm() {
  const pass = newPassword.value.trim();
  const confirm = confirmPassword.value.trim();
  let valid = true;

  // Validate new password
  if (!validatePasswordComplexity(pass)) {
    newPassword.style.borderColor = '#be0808';
    messageBox.textContent = 'Password must be at least 8 characters and include uppercase, lowercase, number, and special character.';
    messageBox.className = 'error';
    valid = false;
  } else {
    newPassword.style.borderColor = 'green';
  }

  // Validate confirm password
  if (pass !== confirm) {
    confirmPassword.style.borderColor = '#be0808';
    messageBox.textContent = 'Passwords do not match.';
    messageBox.className = 'error';
    valid = false;
  } else if (confirm) {
    confirmPassword.style.borderColor = 'green';
  } else {
    confirmPassword.style.borderColor = '#ccc';
  }

  // Enable/disable submit button
  submitBtn.disabled = !valid;
}

newPassword.addEventListener('input', validateForm);
confirmPassword.addEventListener('input', validateForm);

// Form submission
form.addEventListener('submit', async e => {
  e.preventDefault();

  const email = emailInput.value.trim();
  const newPass = newPassword.value.trim();

  try {
    const response = await fetch('forgot-pass.php', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password: newPass })
    });

    const result = await response.json();

    if (result.success) {
      messageBox.textContent = 'Password successfully reset!';
      messageBox.className = 'success';
      newPassword.style.borderColor = 'green';
      confirmPassword.style.borderColor = 'green';
      setTimeout(() => window.location.href = 'login.html', 1500);
    } else {
      messageBox.textContent = result.message || 'Error resetting password.';
      messageBox.className = 'error';
    }
  } catch (error) {
    messageBox.textContent = 'Network error. Please try again.';
    messageBox.className = 'error';
  }
});
</script>

</body>
</html>
